import{c as W,r as o,j as e,C as _,v as K,a as G,B as y,a2 as ie,e as V,p as oe,I as ne,t as ce,s as le,ad as de,ac as me,o as ue,q as xe,m as A,n as X,L as se,S as he,b as pe,ae as ge,d as je,D as fe}from"./index-BzLV8CNE.js";import{u as be}from"./useQuery-PwrN8lgt.js";import{u as B}from"./useMutation-CMAM4n7S.js";import{L as ee}from"./label-ErXilaHi.js";import{T as Ne}from"./textarea-Bgva5FCm.js";import{S as ve,a as ye,b as Ce,c as Se,d as we}from"./select-WeAdnBMh.js";import{D as O,a as $,b as q,c as H,d as U,e as Q,g as De}from"./dialog-Cc9arakq.js";import{V as ke}from"./VideoPlayerModal-DmKj2Fh1.js";import{C as J}from"./circle-play-CwwuRuoJ.js";import{C as Ie,a as Ee}from"./clock-Ds75S8Ae.js";import{I as Re}from"./info-CBDjHlMF.js";import{W as Te}from"./weight-DLv2WyAW.js";import{t as Pe,c as Me,f as Z}from"./format-Cj1jUzCS.js";import{Z as ze}from"./zap-CMjEOO_s.js";import{A as Fe}from"./arrow-left-CY9mcJgZ.js";import{C as Le}from"./calendar-B7v250f8.js";import{E as Ae}from"./eye-DbA9ViTj.js";import{p as _e}from"./parseISO-ChxugJxP.js";/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=W("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=W("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=W("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=W("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);function qe(s,i){const l=+Pe(s);return Me(s,l+i)}function He(s,i){return qe(s,i*1e3)}const ae=o.createContext(void 0),Ue=({children:s})=>{const[i,l]=o.useState(!1),[d,a]=o.useState([]),[n,f]=o.useState(null),[g,x]=o.useState(new Set),[k,h]=o.useState(0),[m,w]=o.useState({}),[N,C]=o.useState(null),[R,I]=o.useState(!1),t=o.useRef(null),c=o.useRef(null),j=()=>{t.current&&clearInterval(t.current),c.current&&clearInterval(c.current)};o.useEffect(()=>(i?t.current=setInterval(()=>h(u=>u+1),1e3):(j(),h(0)),j),[i]);const v=o.useCallback((u,S)=>{var p;return((p=u.find(D=>!S.has(D._id)))==null?void 0:p._id)||null},[]),T=u=>{j(),I(!0),C(u),c.current=setInterval(()=>{C(S=>S!==null&&S>1?S-1:(clearInterval(c.current),I(!1),i&&(t.current=setInterval(()=>h(p=>p+1),1e3)),null))},1e3)},F=o.useCallback(u=>{a(u),l(!0),x(new Set),w({}),f(v(u,new Set))},[v]),P=o.useCallback(()=>{l(!1)},[]),M=o.useCallback(u=>{x(S=>{const p=new Set(S);p.add(u);const D=v(d,p);f(D);const L=d.find(re=>re._id===u),Y=L!=null&&L.descanso?parseInt(L.descanso,10):0;return Y>0&&D&&T(Y),p})},[d,v]),r=o.useCallback(u=>{x(S=>{const p=new Set(S);p.delete(u);const D=v(d,p);return f(D),p})},[d,v]),z={isWorkoutActive:i,startWorkout:F,stopWorkout:P,completeExercise:M,uncompleteExercise:r,activeExerciseId:n,completedExercises:g,elapsedTime:k,updateExerciseLoad:(u,S)=>{w(p=>({...p,[u]:S}))},getExerciseLoad:u=>m[u]||"",restTimeRemaining:N,isResting:R};return e.jsx(ae.Provider,{value:z,children:s})},te=()=>{const s=o.useContext(ae);if(s===void 0)throw new Error("useWorkoutPlayer deve ser usado dentro de um WorkoutPlayerProvider");return s},Qe=({exercise:s,isActive:i,isCompleted:l,onOpenVideo:d})=>{var P,M;const{completeExercise:a,uncompleteExercise:n,updateExerciseLoad:f,getExerciseLoad:g}=te(),[x,k]=o.useState(()=>g(s._id)||s.carga||""),[h,m]=o.useState(i),[w,N]=o.useState(!1),[C,R]=o.useState(x);o.useEffect(()=>{m(i)},[i]);const I=r=>{k(r),f(s._id,r)},t=()=>{a(s._id)},c=()=>{n(s._id)},j=((P=s.exercicioDetalhes)==null?void 0:P.nome)||"Exercício Removido",v=()=>{R(x),N(!0)},T=()=>{N(!1)},F=()=>{I(C),T()};return e.jsxs(_,{className:K("transition-all duration-300 ease-in-out overflow-hidden shadow-md border",l?"bg-green-50 border-green-200 opacity-60":"bg-white",i?"border-indigo-500 shadow-indigo-200 shadow-lg":"border-slate-200"),children:[e.jsxs(G,{className:"flex flex-row items-center justify-between p-4 cursor-pointer",onClick:()=>m(!h),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),l&&c()},className:K("flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition-colors",l?"bg-green-500 text-white hover:bg-green-600":"border-2 border-gray-400"),"aria-label":l?"Desfazer exercício":"Exercício não concluído",children:l?e.jsx(Oe,{size:16}):null}),e.jsx("p",{className:"font-semibold text-gray-800 whitespace-normal",title:j,children:j})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[((M=s.exercicioDetalhes)==null?void 0:M.urlVideo)&&e.jsx(y,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:bg-red-100",onClick:r=>{r.stopPropagation(),d(s.exercicioDetalhes.urlVideo)},children:e.jsx(J,{size:20})}),e.jsx(ie,{className:K("transition-transform",h&&"rotate-180")})]})]}),h&&e.jsx(V,{className:"p-4 pt-0",children:e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-around text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Séries"}),e.jsx("p",{className:"font-bold text-lg",children:s.series||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Repetições"}),e.jsx("p",{className:"font-bold text-lg",children:s.repeticoes||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Descanso"}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(Ie,{size:16,className:"text-gray-500"}),e.jsx("p",{className:"font-bold text-lg",children:s.descanso&&s.descanso.trim()!==""?s.descanso:"-"})]})]})]}),s.observacao&&e.jsxs("div",{className:"space-y-2 pt-2 border-t mt-4",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(Re,{size:16})," Observações do Personal"]}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md border",children:s.observacao})]}),e.jsx("div",{className:"space-y-2 pt-2 border-t mt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(Te,{size:16})," Carga Utilizada (kg)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold text-lg text-gray-800",children:x||"-"}),!l&&e.jsx(y,{variant:"link",className:"text-blue-600 hover:text-blue-800 p-0 h-auto underline",onClick:v,children:"Editar"})]})]})}),!l&&e.jsxs(y,{className:"w-full bg-green-600 hover:bg-green-700 mt-4",onClick:t,children:[e.jsx(oe,{className:"mr-2",size:18})," Concluir Exercício"]})]})}),e.jsx(O,{open:w,onOpenChange:N,children:e.jsxs($,{className:"sm:max-w-[425px]",children:[e.jsxs(q,{children:[e.jsx(H,{children:"Atualizar Carga Utilizada"}),e.jsx(U,{children:"Insira a carga utilizada para este exercício."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("label",{htmlFor:"currentLoad",className:"text-right",children:"Carga (kg)"}),e.jsx(ne,{id:"currentLoad",type:"number",placeholder:"Ex: 20",value:C,onChange:r=>R(r.target.value),className:"col-span-3"})]})}),e.jsxs(Q,{children:[e.jsx(y,{variant:"outline",onClick:T,children:"Cancelar"}),e.jsx(y,{onClick:F,children:"Atualizar"})]})]})})]})},Ke=["Muito Leve","Leve","Moderado","Intenso","Muito Intenso","Máximo Esforço"],Be=({isOpen:s,onClose:i,onSubmit:l,isSubmitting:d,stats:a})=>{const[n,f]=o.useState(""),[g,x]=o.useState(""),k=m=>{const w=Math.floor(m/60).toString().padStart(2,"0"),N=(m%60).toString().padStart(2,"0");return`${w}m ${N}s`},h=()=>{l({pse:n||null,comentario:g.trim()||null})};return e.jsx(O,{open:s,onOpenChange:i,children:e.jsxs($,{className:"sm:max-w-md",children:[e.jsxs(q,{className:"text-center items-center",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-3 w-fit mb-4",children:e.jsx(Ve,{className:"w-8 h-8 text-green-600"})}),e.jsx(H,{className:"text-2xl font-bold",children:"Parabéns!"}),e.jsx(U,{children:"Você concluiu seu treino!"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4 text-center border-y my-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Início"}),e.jsx("p",{className:"font-semibold",children:Z(a.inicio,"HH:mm")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Fim"}),e.jsx("p",{className:"font-semibold",children:Z(a.fim,"HH:mm")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tempo de Treino"}),e.jsx("p",{className:"font-semibold",children:k(a.tempoTotal)})]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(ee,{htmlFor:"pse",children:"O que você achou dessa atividade?"}),e.jsxs(ve,{value:n,onValueChange:m=>f(m),children:[e.jsx(ye,{children:e.jsx(Ce,{placeholder:"Selecione..."})}),e.jsx(Se,{children:Ke.map(m=>e.jsx(we,{value:m,children:m},m))})]}),e.jsx(ee,{htmlFor:"comentario",children:"Se quiser, deixe seu comentário aqui:"}),e.jsx(Ne,{id:"comentario",placeholder:"...",value:g,onChange:m=>x(m.target.value)})]}),e.jsx(Q,{className:"mt-4",children:e.jsxs(y,{type:"button",onClick:h,disabled:d,className:"w-full",children:[d?e.jsx(X,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(We,{className:"w-4 h-4 mr-2"}),"Concluir"]})})]})})},fs=()=>e.jsxs(Ue,{children:[" ",e.jsx(Ye,{})," "]}),Ze=({isOpen:s,onClose:i,onConfirm:l,diaDeTreino:d})=>e.jsx(O,{open:s,onOpenChange:i,children:e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(H,{children:"Pronto para começar?"}),e.jsxs(U,{children:["Você está prestes a iniciar o treino: ",e.jsxs("span",{className:"font-bold",children:[d.identificadorDia,d.nomeSubFicha&&` - ${d.nomeSubFicha}`]})]})]}),e.jsxs(Q,{className:"sm:justify-between gap-2",children:[e.jsx(De,{asChild:!0,children:e.jsx(y,{type:"button",variant:"secondary",children:"Cancelar"})}),e.jsxs(y,{type:"button",onClick:l,children:[e.jsx(J,{className:"mr-2 h-4 w-4"})," Iniciar Treino"]})]})]})}),Ge=({isOpen:s,onClose:i,diaDeTreino:l})=>{const d=l.exerciciosDoDia.filter(a=>a.exercicioId&&typeof a.exercicioId=="object").sort((a,n)=>a.ordemNoDia-n.ordemNoDia);return e.jsx(O,{open:s,onOpenChange:i,children:e.jsxs($,{className:"sm:max-w-md",children:[e.jsxs(q,{children:[e.jsxs(H,{children:[l.identificadorDia,l.nomeSubFicha&&` - ${l.nomeSubFicha}`]}),e.jsx(U,{children:"Lista de exercícios para este dia."})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-4 my-4",children:e.jsx("ul",{className:"space-y-3",children:d.map(a=>e.jsx("li",{className:"text-sm p-2 bg-slate-50 rounded-md",children:a.exercicioId.nome},a._id))})}),e.jsx(Q,{children:e.jsx(y,{type:"button",onClick:i,children:"Fechar"})})]})})},Xe=({diaAtivo:s,rotinaId:i,onFinishWorkout:l,isFinishing:d})=>{const{startWorkout:a,stopWorkout:n,elapsedTime:f,activeExerciseId:g,completedExercises:x,getExerciseLoad:k}=te(),[h,m]=o.useState(null),[w]=o.useState(()=>new Date),N=o.useMemo(()=>s.exerciciosDoDia.map(t=>t.exercicioId&&typeof t.exercicioId=="object"?{...t,_id:t._id,exercicioDetalhes:t.exercicioId}:null).filter(t=>t!==null).sort((t,c)=>t.ordemNoDia-c.ordemNoDia),[s.exerciciosDoDia]);o.useEffect(()=>{const t=s.exerciciosDoDia.map(c=>c.exercicioId&&typeof c.exercicioId=="object"?{_id:c._id,exercicioDetalhes:c.exercicioId,descanso:c.descanso}:null).filter(c=>c!==null).sort((c,j)=>c.ordemNoDia-j.ordemNoDia);a(t)},[a,s]);const C=()=>{const t=N.reduce((c,j)=>(c[j._id]=k(j._id),c),{});l({duracao:f,cargas:t,dataInicio:w}),n()},R=t=>{const c=Math.floor(t/3600).toString().padStart(2,"0"),j=Math.floor(t%3600/60).toString().padStart(2,"0"),v=(t%60).toString().padStart(2,"0");return c!=="00"?`${c}:${j}:${v}`:`${j}:${v}`},I=t=>{t&&m(t.includes("watch?v=")?t.replace("watch?v=","embed/"):t)};return e.jsxs(_,{className:"bg-white/95 backdrop-blur-sm text-gray-800 rounded-2xl shadow-lg border-0 h-full flex flex-col",children:[e.jsxs(G,{className:"flex-shrink-0",children:[e.jsx(se,{href:`/aluno/ficha/${i}`,children:e.jsxs(y,{variant:"outline",size:"sm",className:"mb-2",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"})," Cancelar Treino"]})}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("h3",{className:"font-bold text-lg",children:s.identificadorDia}),e.jsxs("div",{className:"flex items-center gap-2 font-mono text-lg bg-gray-800 text-white px-3 py-1 rounded-lg",children:[e.jsx($e,{size:20}),e.jsx("span",{children:R(f)})]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Exercícios Concluídos: ",x.size," / ",N.length]})]}),e.jsx(V,{className:"flex-grow overflow-y-auto px-4 pb-4 space-y-3",children:N.map(t=>e.jsx(Qe,{exercise:t,isActive:t._id===g,isCompleted:x.has(t._id),onOpenVideo:()=>{var c;return I((c=t.exercicioDetalhes)==null?void 0:c.urlVideo)}},t._id))}),e.jsx(he,{className:"flex-shrink-0 p-4 mt-4 border-t sticky bottom-0 bg-white",children:e.jsxs(y,{onClick:C,disabled:d,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-md",size:"lg",children:[d?e.jsx(X,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(ze,{className:"w-5 h-5 mr-2"})," Finalizar e Salvar Treino"]})}),e.jsx(ke,{videoUrl:h,onClose:()=>m(null)})]})},Je=({rotina:s,onSelectDiaParaIniciar:i,onSelectDiaParaVer:l})=>{const d=o.useMemo(()=>[...s.diasDeTreino||[]].sort((a,n)=>a.ordemNaRotina-n.ordemNaRotina),[s.diasDeTreino]);return e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsx(se,{href:"/aluno/dashboard",children:e.jsxs(y,{variant:"outline",size:"sm",className:"bg-white/20 hover:bg-white/30 border-white/50 text-white rounded-lg",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Voltar ao Painel"]})})}),e.jsxs(_,{className:"bg-white/95 backdrop-blur-sm text-gray-800 rounded-2xl shadow-lg border-0",children:[e.jsxs(G,{children:[e.jsxs(pe,{className:"text-2xl sm:text-3xl font-bold text-indigo-700 flex items-center gap-3",children:[e.jsx(ge,{className:"w-8 h-8"}),s.titulo]}),s.descricao&&e.jsx(je,{className:"pt-1",children:s.descricao}),s.dataValidade&&e.jsxs("p",{className:"text-sm text-muted-foreground pt-2 flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"})," Válida até: ",Z(_e(s.dataValidade),"dd/MM/yyyy")]})]}),e.jsxs(V,{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 mt-2 flex items-center text-gray-800",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"})," Dias da Rotina "]}),e.jsx("div",{className:"space-y-3",children:d.map(a=>e.jsx(_,{className:"w-full text-left bg-white hover:bg-slate-50 transition-colors duration-200 shadow-sm",children:e.jsx(V,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-800",children:[a.identificadorDia,a.nomeSubFicha&&` - ${a.nomeSubFicha}`]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.exerciciosDoDia.length," exercícios"]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx(y,{size:"icon",variant:"outline",onClick:()=>l(a),"aria-label":"Ver detalhes do treino",children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsx(y,{size:"icon",onClick:()=>i(a),"aria-label":"Iniciar treino",children:e.jsx(J,{className:"w-4 h-4"})})]})]})})},a._id))})]})]})]})},Ye=()=>{const i=ce().fichaId,[,l]=le(),d=de(),a=new URLSearchParams(d).get("diaId"),{aluno:n}=me(),{toast:f}=ue(),g=xe(),[x,k]=o.useState(null),[h,m]=o.useState(null),[w,N]=o.useState(null),{data:C,isLoading:R,error:I}=be({queryKey:["alunoRotinaDetalhe",i],queryFn:()=>A("GET",`/api/aluno/meus-treinos/${i}`,void 0,"aluno"),enabled:!!i&&!!n}),t=o.useMemo(()=>!C||!a?null:C.diasDeTreino.find(r=>r._id===a)||null,[C,a]),c=()=>{!h||!i||(l(`/aluno/ficha/${i}?diaId=${h._id}`),m(null))},j=B({mutationFn:({cargas:r})=>A("PATCH",`/api/aluno/meus-treinos/${i}/cargas`,{diaDeTreinoId:a,cargas:r},"aluno"),onSuccess:()=>{console.log("Cargas na ficha atualizadas com sucesso!"),g.invalidateQueries({queryKey:["alunoRotinaDetalhe",i]})},onError:r=>{console.error("Erro ao atualizar cargas na ficha:",r.message)}}),v=B({onMutate:async()=>{console.log("Iniciando mutação otimista..."),await g.cancelQueries({queryKey:["minhasRotinasAluno",n==null?void 0:n.id]});const r=g.getQueryData(["minhasRotinasAluno",n==null?void 0:n.id]);if(r){const E=r.map(b=>{if(b._id===i){const z=b.diasDeTreino;if(!z||z.length===0)return b;const u=Math.max(...z.map(D=>D.ordemNaRotina)),S=z.map(D=>D._id===a?{...D,ordemNaRotina:u+1}:D),p=(b.sessoesRotinaConcluidas||0)+1;return console.log(`Atualização otimista: Rotina ${b.titulo} agora tem ${p} sessões concluídas. Dia ${a} movido para ordem ${u+1}.`),{...b,sessoesRotinaConcluidas:p,diasDeTreino:S}}return b});g.setQueryData(["minhasRotinasAluno",n==null?void 0:n.id],E)}return{previousRotinas:r}},onError:(r,E,b)=>{console.error("Mutação otimista falhou. Revertendo cache."),b!=null&&b.previousRotinas&&g.setQueryData(["minhasRotinasAluno",n==null?void 0:n.id],b.previousRotinas),f({title:"Erro ao Finalizar Treino",description:r.message,variant:"destructive"})},onSettled:()=>{console.log("onSettled executado: Nenhuma invalidação forçada para 'minhasRotinasAluno'.")},mutationFn:r=>A("POST","/api/sessions/aluno/concluir-dia",r.payload,"aluno"),onSuccess:(r,E)=>{console.log("Mutação no backend bem-sucedida."),f({title:"Dia de Treino Salvo!",description:"Ótimo trabalho! Agora, conte-nos como foi."});const b=He(E.dataInicio,E.payload.duracaoSegundos);k({sessaoId:r._id,stats:{inicio:E.dataInicio,fim:b,tempoTotal:E.payload.duracaoSegundos}}),j.mutate({cargas:E.payload.cargas}),g.invalidateQueries({queryKey:["frequenciaSemanalAluno",n==null?void 0:n.id]}),g.invalidateQueries({queryKey:["statsProgressoAluno",n==null?void 0:n.id]})}}),T=B({mutationFn:r=>A("PATCH",`/api/sessions/${r.sessaoId}/feedback`,r,"aluno"),onSuccess:()=>{f({title:"Feedback Enviado!",description:"Obrigado! Redirecionando..."}),setTimeout(()=>{k(null),l("/aluno/dashboard")},1e3)},onError:r=>f({title:"Erro ao Enviar Feedback",description:r.message,variant:"destructive"})}),F=r=>{!i||!a||v.mutate({payload:{rotinaId:i,diaDeTreinoId:a,duracaoSegundos:r.duracao,cargas:r.cargas},dataInicio:r.dataInicio})},P=r=>{x&&T.mutate({sessaoId:x.sessaoId,pseAluno:r.pse,comentarioAluno:r.comentario})};if(R)return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center",children:e.jsx(X,{className:"h-10 w-10 animate-spin text-white"})});if(I)return e.jsxs("div",{children:["Erro: ",I.message]});if(!C)return e.jsx("div",{children:"Rotina não encontrada."});const M=()=>a&&t?e.jsx(Xe,{diaAtivo:t,rotinaId:i,onFinishWorkout:F,isFinishing:v.isPending}):e.jsx(Je,{rotina:C,onSelectDiaParaIniciar:m,onSelectDiaParaVer:N});return e.jsxs("div",{className:"h-full",children:[M(),h&&e.jsx(Ze,{isOpen:!!h,onClose:()=>m(null),onConfirm:c,diaDeTreino:h}),w&&e.jsx(Ge,{isOpen:!!w,onClose:()=>N(null),diaDeTreino:w}),x&&e.jsx(Be,{isOpen:!!x,onClose:()=>k(null),onSubmit:P,isSubmitting:T.isPending,stats:x.stats})]})};export{fs as default};
