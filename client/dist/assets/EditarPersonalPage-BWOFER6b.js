import{t as F,s as E,o as T,q as b,r as P,j as e,au as L,C as N,a as q,b as D,ag as M,d as A,e as I,I as j,S as Q,B as R,m as h}from"./index-BzLV8CNE.js";import{u as w}from"./useQuery-PwrN8lgt.js";import{u as V}from"./useMutation-CMAM4n7S.js";import{u as z,t as B,o as K,e as U,s as f}from"./types-BCbViMJN.js";import{F as $,a as i,b as t,c as l,d as m,e as d}from"./form-Bay0436k.js";import{S as G,a as H,b as O,c as k,d as g}from"./select-WeAdnBMh.js";import{L as J}from"./LoadingSpinner-CMtr6_ld.js";import{E as W}from"./ErrorMessage-CKvNOnls.js";import"./label-ErXilaHi.js";import"./triangle-alert-BMd-Rj3a.js";const X=K({nome:f().min(3,"O nome deve ter pelo menos 3 caracteres."),email:f().email("Email inválido."),role:U(["personal-trainer","admin"],{errorMap:()=>({message:"Função inválida."})})});function te(){const{id:o}=F(),[,S]=E(),{toast:c}=T(),u=b(),{data:s,isLoading:y,error:x,isSuccess:p}=w({queryKey:["personalDetails",o],queryFn:()=>h("GET",`/api/admin/personal-trainers/${o}`),enabled:!!o}),r=z({resolver:B(X),defaultValues:{nome:"",email:"",role:"personal-trainer"}});P.useEffect(()=>{p&&s&&r.reset({nome:s.nome,email:s.email,role:s.role.toLowerCase()==="admin"?"admin":"personal-trainer"})},[p,s,r]);const n=V({mutationFn:a=>h("PUT",`/api/admin/personal-trainers/${o}`,a),onSuccess:a=>{c({title:"Sucesso!",description:"Dados do personal atualizados."}),u.invalidateQueries({queryKey:["adminPersonalTrainersList"]}),u.setQueryData(["personalDetails",o],a),S("/admin/gerenciar-personais")},onError:a=>{c({variant:"destructive",title:"Erro ao atualizar",description:a.message})}}),C=a=>{const v={...a,role:a.role==="admin"?"Admin":"Personal Trainer"};n.mutate(v)};return o?y?e.jsx(J,{text:"Carregando dados do personal..."}):x?e.jsx(W,{title:"Erro ao carregar",message:x.message}):e.jsx("div",{className:"container mx-auto py-8 px-4",children:e.jsxs(N,{className:"max-w-2xl mx-auto",children:[e.jsxs(q,{children:[e.jsxs(D,{className:"flex items-center text-2xl",children:[e.jsx(M,{className:"mr-3 h-7 w-7 text-primary"}),"Editar Personal"]}),e.jsxs(A,{children:["Altere os dados de ",s==null?void 0:s.nome,"."]})]}),e.jsx($,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(C),children:[e.jsxs(I,{className:"space-y-6",children:[e.jsx(i,{control:r.control,name:"nome",render:({field:a})=>e.jsxs(t,{children:[e.jsx(l,{children:"Nome Completo"}),e.jsx(m,{children:e.jsx(j,{placeholder:"Nome do Personal",...a})}),e.jsx(d,{})]})}),e.jsx(i,{control:r.control,name:"email",render:({field:a})=>e.jsxs(t,{children:[e.jsx(l,{children:"Email"}),e.jsx(m,{children:e.jsx(j,{type:"email",placeholder:"email@dominio.com",...a})}),e.jsx(d,{})]})}),e.jsx(i,{control:r.control,name:"role",render:({field:a})=>e.jsxs(t,{children:[e.jsx(l,{children:"Função (Role)"}),e.jsxs(G,{onValueChange:a.onChange,value:a.value,children:[e.jsx(m,{children:e.jsx(H,{children:e.jsx(O,{placeholder:"Selecione a função"})})}),e.jsxs(k,{children:[e.jsx(g,{value:"personal-trainer",children:"Personal Trainer"}),e.jsx(g,{value:"admin",children:"Administrador"})]})]}),e.jsx(d,{})]})})]}),e.jsx(Q,{className:"flex justify-end",children:e.jsx(R,{type:"submit",disabled:n.isPending,children:n.isPending?"Salvando...":"Salvar Alterações"})})]})})]})}):e.jsx(L,{to:"/admin/gerenciar-personais"})}export{te as default};
