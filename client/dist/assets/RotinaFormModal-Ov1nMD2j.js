import{c as U,V as ye,r as i,W as De,j as e,X as Xe,P as H,Y as W,Z as ne,_ as X,$ as Ye,R as L,a0 as Go,a1 as Ge,v as le,a2 as Ke,D as Ko,C as ae,a as Qo,b as Jo,e as Qe,U as Zo,G as er,J as or,K as rr,B as R,N as tr,a3 as G,o as Je,I as q,n as Ze,l as sr,q as ar,m as Ve}from"./index-BzLV8CNE.js";import{D as ce,a as de,b as ue,c as me,d as he,e as pe}from"./dialog-Cc9arakq.js";import{T as nr,a as lr,b as He,c as te,d as ir,e as se}from"./table-C_2_dIR3.js";import{B as $e}from"./badge-mwLuO-R-.js";import{I as cr}from"./info-CBDjHlMF.js";import{C as Be,a as dr}from"./clock-Ds75S8Ae.js";import{C as ur}from"./circle-play-CwwuRuoJ.js";import{S as eo}from"./square-pen-DXG1TAJA.js";import{u as oo}from"./useQuery-PwrN8lgt.js";import{u as mr}from"./useMutation-CMAM4n7S.js";import{L as Y}from"./label-ErXilaHi.js";import{e as hr,C as pr,S as Q,a as J,b as Z,c as ee,d as K}from"./select-WeAdnBMh.js";import{T as We}from"./textarea-Bgva5FCm.js";import{T as xr,a as fr,b as ie,F as br}from"./tabs-Dt_cpVbU.js";import{T as vr}from"./trash-2-CwwKKaCS.js";import{T as gr}from"./triangle-alert-BMd-Rj3a.js";import{A as jr}from"./arrow-left-CY9mcJgZ.js";/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=U("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=U("BookCopy",[["path",{d:"M2 16V4a2 2 0 0 1 2-2h11",key:"spzkk5"}],["path",{d:"M5 14H4a2 2 0 1 0 0 4h1",key:"16gqf9"}],["path",{d:"M22 18H11a2 2 0 1 0 0 4h11V6H11a2 2 0 0 0-2 2v12",key:"1owzki"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=U("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=U("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=U("CopyPlus",[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=U("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=U("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=U("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=U("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var ve="Collapsible",[Tr,ro]=ye(ve),[Er,Ae]=Tr(ve),to=i.forwardRef((o,s)=>{const{__scopeCollapsible:r,open:n,defaultOpen:t,disabled:a,onOpenChange:d,...c}=o,[p,h]=De({prop:n,defaultProp:t??!1,onChange:d,caller:ve});return e.jsx(Er,{scope:r,disabled:a,contentId:Xe(),open:p,onOpenToggle:i.useCallback(()=>h(u=>!u),[h]),children:e.jsx(H.div,{"data-state":Te(p),"data-disabled":a?"":void 0,...c,ref:s})})});to.displayName=ve;var so="CollapsibleTrigger",ao=i.forwardRef((o,s)=>{const{__scopeCollapsible:r,...n}=o,t=Ae(so,r);return e.jsx(H.button,{type:"button","aria-controls":t.contentId,"aria-expanded":t.open||!1,"data-state":Te(t.open),"data-disabled":t.disabled?"":void 0,disabled:t.disabled,...n,ref:s,onClick:W(o.onClick,t.onOpenToggle)})});ao.displayName=so;var Re="CollapsibleContent",no=i.forwardRef((o,s)=>{const{forceMount:r,...n}=o,t=Ae(Re,o.__scopeCollapsible);return e.jsx(ne,{present:r||t.open,children:({present:a})=>e.jsx(Ir,{...n,ref:s,present:a})})});no.displayName=Re;var Ir=i.forwardRef((o,s)=>{const{__scopeCollapsible:r,present:n,children:t,...a}=o,d=Ae(Re,r),[c,p]=i.useState(n),h=i.useRef(null),u=X(s,h),m=i.useRef(0),x=m.current,b=i.useRef(0),w=b.current,N=d.open||c,D=i.useRef(N),y=i.useRef(void 0);return i.useEffect(()=>{const S=requestAnimationFrame(()=>D.current=!1);return()=>cancelAnimationFrame(S)},[]),Ye(()=>{const S=h.current;if(S){y.current=y.current||{transitionDuration:S.style.transitionDuration,animationName:S.style.animationName},S.style.transitionDuration="0s",S.style.animationName="none";const T=S.getBoundingClientRect();m.current=T.height,b.current=T.width,D.current||(S.style.transitionDuration=y.current.transitionDuration,S.style.animationName=y.current.animationName),p(n)}},[d.open,n]),e.jsx(H.div,{"data-state":Te(d.open),"data-disabled":d.disabled?"":void 0,id:d.contentId,hidden:!N,...a,ref:u,style:{"--radix-collapsible-content-height":x?`${x}px`:void 0,"--radix-collapsible-content-width":w?`${w}px`:void 0,...o.style},children:N&&t})});function Te(o){return o?"open":"closed"}var _r=to,Pr=ao,kr=no,V="Accordion",Lr=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ee,Mr,Fr]=Go(V),[ge,Tt]=ye(V,[Fr,ro]),Ie=ro(),lo=L.forwardRef((o,s)=>{const{type:r,...n}=o,t=n,a=n;return e.jsx(Ee.Provider,{scope:o.__scopeAccordion,children:r==="multiple"?e.jsx(Hr,{...a,ref:s}):e.jsx(Vr,{...t,ref:s})})});lo.displayName=V;var[io,Or]=ge(V),[co,zr]=ge(V,{collapsible:!1}),Vr=L.forwardRef((o,s)=>{const{value:r,defaultValue:n,onValueChange:t=()=>{},collapsible:a=!1,...d}=o,[c,p]=De({prop:r,defaultProp:n??"",onChange:t,caller:V});return e.jsx(io,{scope:o.__scopeAccordion,value:L.useMemo(()=>c?[c]:[],[c]),onItemOpen:p,onItemClose:L.useCallback(()=>a&&p(""),[a,p]),children:e.jsx(co,{scope:o.__scopeAccordion,collapsible:a,children:e.jsx(uo,{...d,ref:s})})})}),Hr=L.forwardRef((o,s)=>{const{value:r,defaultValue:n,onValueChange:t=()=>{},...a}=o,[d,c]=De({prop:r,defaultProp:n??[],onChange:t,caller:V}),p=L.useCallback(u=>c((m=[])=>[...m,u]),[c]),h=L.useCallback(u=>c((m=[])=>m.filter(x=>x!==u)),[c]);return e.jsx(io,{scope:o.__scopeAccordion,value:d,onItemOpen:p,onItemClose:h,children:e.jsx(co,{scope:o.__scopeAccordion,collapsible:!0,children:e.jsx(uo,{...a,ref:s})})})}),[$r,je]=ge(V),uo=L.forwardRef((o,s)=>{const{__scopeAccordion:r,disabled:n,dir:t,orientation:a="vertical",...d}=o,c=L.useRef(null),p=X(c,s),h=Mr(r),m=Ge(t)==="ltr",x=W(o.onKeyDown,b=>{var C;if(!Lr.includes(b.key))return;const w=b.target,N=h().filter(f=>{var j;return!((j=f.ref.current)!=null&&j.disabled)}),D=N.findIndex(f=>f.ref.current===w),y=N.length;if(D===-1)return;b.preventDefault();let S=D;const T=0,A=y-1,E=()=>{S=D+1,S>A&&(S=T)},P=()=>{S=D-1,S<T&&(S=A)};switch(b.key){case"Home":S=T;break;case"End":S=A;break;case"ArrowRight":a==="horizontal"&&(m?E():P());break;case"ArrowDown":a==="vertical"&&E();break;case"ArrowLeft":a==="horizontal"&&(m?P():E());break;case"ArrowUp":a==="vertical"&&P();break}const F=S%y;(C=N[F].ref.current)==null||C.focus()});return e.jsx($r,{scope:r,disabled:n,direction:t,orientation:a,children:e.jsx(Ee.Slot,{scope:r,children:e.jsx(H.div,{...d,"data-orientation":a,ref:p,onKeyDown:n?void 0:x})})})}),xe="AccordionItem",[Br,_e]=ge(xe),mo=L.forwardRef((o,s)=>{const{__scopeAccordion:r,value:n,...t}=o,a=je(xe,r),d=Or(xe,r),c=Ie(r),p=Xe(),h=n&&d.value.includes(n)||!1,u=a.disabled||o.disabled;return e.jsx(Br,{scope:r,open:h,disabled:u,triggerId:p,children:e.jsx(_r,{"data-orientation":a.orientation,"data-state":vo(h),...c,...t,ref:s,disabled:u,open:h,onOpenChange:m=>{m?d.onItemOpen(n):d.onItemClose(n)}})})});mo.displayName=xe;var ho="AccordionHeader",po=L.forwardRef((o,s)=>{const{__scopeAccordion:r,...n}=o,t=je(V,r),a=_e(ho,r);return e.jsx(H.h3,{"data-orientation":t.orientation,"data-state":vo(a.open),"data-disabled":a.disabled?"":void 0,...n,ref:s})});po.displayName=ho;var Ne="AccordionTrigger",xo=L.forwardRef((o,s)=>{const{__scopeAccordion:r,...n}=o,t=je(V,r),a=_e(Ne,r),d=zr(Ne,r),c=Ie(r);return e.jsx(Ee.ItemSlot,{scope:r,children:e.jsx(Pr,{"aria-disabled":a.open&&!d.collapsible||void 0,"data-orientation":t.orientation,id:a.triggerId,...c,...n,ref:s})})});xo.displayName=Ne;var fo="AccordionContent",bo=L.forwardRef((o,s)=>{const{__scopeAccordion:r,...n}=o,t=je(V,r),a=_e(fo,r),d=Ie(r);return e.jsx(kr,{role:"region","aria-labelledby":a.triggerId,"data-orientation":t.orientation,...d,...n,ref:s,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...o.style}})});bo.displayName=fo;function vo(o){return o?"open":"closed"}var Wr=lo,Ur=mo,qr=po,go=xo,jo=bo;const Xr=Wr,wo=i.forwardRef(({className:o,...s},r)=>e.jsx(Ur,{ref:r,className:le("border-b",o),...s}));wo.displayName="AccordionItem";const So=i.forwardRef(({className:o,children:s,...r},n)=>e.jsx(qr,{className:"flex",children:e.jsxs(go,{ref:n,className:le("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",o),...r,children:[s,e.jsx(Ke,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));So.displayName=go.displayName;const Co=i.forwardRef(({className:o,children:s,...r},n)=>e.jsx(jo,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:le("pb-4 pt-0",o),children:s})}));Co.displayName=jo.displayName;const Ue=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return"Data inválida"}},Et=({isOpen:o,onClose:s,rotina:r,onEdit:n,onAssign:t,onPlayVideo:a,onConvertToModel:d})=>{var h,u;if(!o||!r)return null;const c=r.tipo==="modelo",p=typeof r.alunoId=="object"&&((h=r.alunoId)!=null&&h.nome)?r.alunoId.nome:"N/A";return e.jsx(ce,{open:o,onOpenChange:s,children:e.jsxs(de,{className:"sm:max-w-3xl w-[95vw] h-[90vh] flex flex-col p-0",children:[e.jsxs(ue,{className:"p-6 pb-4 border-b",children:[e.jsxs(me,{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(Ko,{className:"h-7 w-7 text-primary"}),r.titulo]}),e.jsx(he,{children:r.descricao||"Visualização detalhada da rotina de treino."})]}),e.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[e.jsxs(ae,{className:"mb-6 bg-slate-50 dark:bg-slate-800/50",children:[e.jsx(Qo,{children:e.jsxs(Jo,{className:"text-lg flex items-center",children:[e.jsx(cr,{className:"h-5 w-5 mr-2"}),"Informações Gerais"]})}),e.jsxs(Qe,{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs($e,{variant:c?"outline":"default",className:c?"border-purple-400 text-purple-600 dark:border-purple-600 dark:text-purple-400":"bg-teal-100 text-teal-800 border-transparent hover:bg-teal-100/80 dark:bg-teal-900/50 dark:text-teal-300",children:[c?e.jsx(Ar,{className:"h-3 w-3 mr-1.5"}):e.jsx(Zo,{className:"h-3 w-3 mr-1.5"}),c?"Modelo":"Individual"]}),r.isCopied&&e.jsx($e,{variant:"secondary",className:"bg-blue-100 text-blue-800 border-transparent dark:bg-blue-900/50 dark:text-blue-300",children:"Rotina Copiada"})]}),!c&&e.jsxs("div",{className:"font-medium",children:[e.jsx("strong",{children:"Aluno:"})," ",p]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Dias de Treino:"})," ",((u=r.diasDeTreino)==null?void 0:u.length)||0]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-400",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsxs("span",{children:["Criada em: ",Ue(r.criadoEm)]})]}),r.atualizadoEm&&new Date(r.criadoEm||0).getTime()!==new Date(r.atualizadoEm).getTime()&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-400",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsxs("span",{children:["Atualizada em: ",Ue(r.atualizadoEm)]})]})]})]}),e.jsx(Xr,{type:"multiple",className:"w-full space-y-3",children:(r.diasDeTreino||[]).sort((m,x)=>m.ordemNaRotina-x.ordemNaRotina).map(m=>e.jsxs(wo,{value:m._id||m.identificadorDia,className:"border dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs(So,{className:"px-4 py-3 bg-slate-100 dark:bg-slate-800 hover:no-underline font-semibold",children:[m.identificadorDia," ",m.nomeSubFicha&&e.jsxs("span",{className:"font-normal text-muted-foreground ml-2",children:["- ",m.nomeSubFicha]})]}),e.jsx(Co,{className:"p-0",children:m.exerciciosDoDia&&m.exerciciosDoDia.length>0?e.jsxs(nr,{children:[e.jsx(lr,{children:e.jsxs(He,{children:[e.jsx(te,{className:"pl-4",children:"Exercício"}),e.jsx(te,{className:"text-center w-[70px]",children:"Séries"}),e.jsx(te,{className:"text-center w-[70px]",children:"Reps"}),e.jsx(te,{children:"Carga"}),e.jsx(te,{className:"pr-4",children:"Descanso"})]})}),e.jsx(ir,{children:(m.exerciciosDoDia||[]).filter(x=>x.exercicioId).sort((x,b)=>x.ordemNoDia-b.ordemNoDia).map(x=>{const b=typeof x.exercicioId=="object"?x.exercicioId:null;return e.jsxs(He,{children:[e.jsxs(se,{className:"font-medium pl-4 flex items-center gap-2",children:[b==null?void 0:b.nome,(b==null?void 0:b.urlVideo)&&e.jsx(er,{delayDuration:100,children:e.jsxs(or,{children:[e.jsx(rr,{asChild:!0,children:e.jsx(R,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>a(b.urlVideo),children:e.jsx(ur,{className:"h-4 w-4 text-primary opacity-60 hover:opacity-100"})})}),e.jsx(tr,{children:e.jsx("p",{children:"Ver vídeo"})})]})})]}),e.jsx(se,{className:"text-center",children:x.series||"-"}),e.jsx(se,{className:"text-center",children:x.repeticoes||"-"}),e.jsx(se,{children:x.carga||"-"}),e.jsx(se,{className:"pr-4",children:x.descanso||"-"})]},x._id)})})]}):e.jsx("div",{className:"text-center text-sm text-muted-foreground p-4",children:"Nenhum exercício cadastrado para este dia."})})]},m._id))})]}),e.jsxs(pe,{className:"p-4 border-t flex-wrap justify-end gap-2",children:[c&&e.jsxs(R,{onClick:()=>t(r._id,r.titulo),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(yr,{className:"w-4 h-4 mr-2"}),"Usar este Modelo"]}),!c&&e.jsxs(R,{onClick:()=>d(r),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(Sr,{className:"w-4 h-4 mr-2"}),"Tornar Modelo"]}),e.jsxs(R,{variant:"outline",onClick:()=>n(r),children:[e.jsx(eo,{className:"w-4 h-4 mr-2"}),"Editar Rotina"]}),e.jsx(R,{variant:"secondary",onClick:s,children:"Fechar"})]})]})})};function Yr(o,s){return i.useReducer((r,n)=>s[r][n]??r,o)}var Pe="ScrollArea",[No,It]=ye(Pe),[Gr,z]=No(Pe),yo=i.forwardRef((o,s)=>{const{__scopeScrollArea:r,type:n="hover",dir:t,scrollHideDelay:a=600,...d}=o,[c,p]=i.useState(null),[h,u]=i.useState(null),[m,x]=i.useState(null),[b,w]=i.useState(null),[N,D]=i.useState(null),[y,S]=i.useState(0),[T,A]=i.useState(0),[E,P]=i.useState(!1),[F,C]=i.useState(!1),f=X(s,_=>p(_)),j=Ge(t);return e.jsx(Gr,{scope:r,type:n,dir:j,scrollHideDelay:a,scrollArea:c,viewport:h,onViewportChange:u,content:m,onContentChange:x,scrollbarX:b,onScrollbarXChange:w,scrollbarXEnabled:E,onScrollbarXEnabledChange:P,scrollbarY:N,onScrollbarYChange:D,scrollbarYEnabled:F,onScrollbarYEnabledChange:C,onCornerWidthChange:S,onCornerHeightChange:A,children:e.jsx(H.div,{dir:j,...d,ref:f,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":T+"px",...o.style}})})});yo.displayName=Pe;var Do="ScrollAreaViewport",Ao=i.forwardRef((o,s)=>{const{__scopeScrollArea:r,children:n,nonce:t,...a}=o,d=z(Do,r),c=i.useRef(null),p=X(s,c,d.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:t}),e.jsx(H.div,{"data-radix-scroll-area-viewport":"",...a,ref:p,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...o.style},children:e.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Ao.displayName=Do;var $="ScrollAreaScrollbar",ke=i.forwardRef((o,s)=>{const{forceMount:r,...n}=o,t=z($,o.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:d}=t,c=o.orientation==="horizontal";return i.useEffect(()=>(c?a(!0):d(!0),()=>{c?a(!1):d(!1)}),[c,a,d]),t.type==="hover"?e.jsx(Kr,{...n,ref:s,forceMount:r}):t.type==="scroll"?e.jsx(Qr,{...n,ref:s,forceMount:r}):t.type==="auto"?e.jsx(Ro,{...n,ref:s,forceMount:r}):t.type==="always"?e.jsx(Le,{...n,ref:s}):null});ke.displayName=$;var Kr=i.forwardRef((o,s)=>{const{forceMount:r,...n}=o,t=z($,o.__scopeScrollArea),[a,d]=i.useState(!1);return i.useEffect(()=>{const c=t.scrollArea;let p=0;if(c){const h=()=>{window.clearTimeout(p),d(!0)},u=()=>{p=window.setTimeout(()=>d(!1),t.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",u),()=>{window.clearTimeout(p),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",u)}}},[t.scrollArea,t.scrollHideDelay]),e.jsx(ne,{present:r||a,children:e.jsx(Ro,{"data-state":a?"visible":"hidden",...n,ref:s})})}),Qr=i.forwardRef((o,s)=>{const{forceMount:r,...n}=o,t=z($,o.__scopeScrollArea),a=o.orientation==="horizontal",d=Se(()=>p("SCROLL_END"),100),[c,p]=Yr("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>p("HIDE"),t.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,t.scrollHideDelay,p]),i.useEffect(()=>{const h=t.viewport,u=a?"scrollLeft":"scrollTop";if(h){let m=h[u];const x=()=>{const b=h[u];m!==b&&(p("SCROLL"),d()),m=b};return h.addEventListener("scroll",x),()=>h.removeEventListener("scroll",x)}},[t.viewport,a,p,d]),e.jsx(ne,{present:r||c!=="hidden",children:e.jsx(Le,{"data-state":c==="hidden"?"hidden":"visible",...n,ref:s,onPointerEnter:W(o.onPointerEnter,()=>p("POINTER_ENTER")),onPointerLeave:W(o.onPointerLeave,()=>p("POINTER_LEAVE"))})})}),Ro=i.forwardRef((o,s)=>{const r=z($,o.__scopeScrollArea),{forceMount:n,...t}=o,[a,d]=i.useState(!1),c=o.orientation==="horizontal",p=Se(()=>{if(r.viewport){const h=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;d(c?h:u)}},10);return oe(r.viewport,p),oe(r.content,p),e.jsx(ne,{present:n||a,children:e.jsx(Le,{"data-state":a?"visible":"hidden",...t,ref:s})})}),Le=i.forwardRef((o,s)=>{const{orientation:r="vertical",...n}=o,t=z($,o.__scopeScrollArea),a=i.useRef(null),d=i.useRef(0),[c,p]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Po(c.viewport,c.content),u={...n,sizes:c,onSizesChange:p,hasThumb:h>0&&h<1,onThumbChange:x=>a.current=x,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:x=>d.current=x};function m(x,b){return tt(x,d.current,c,b)}return r==="horizontal"?e.jsx(Jr,{...u,ref:s,onThumbPositionChange:()=>{if(t.viewport&&a.current){const x=t.viewport.scrollLeft,b=qe(x,c,t.dir);a.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:x=>{t.viewport&&(t.viewport.scrollLeft=x)},onDragScroll:x=>{t.viewport&&(t.viewport.scrollLeft=m(x,t.dir))}}):r==="vertical"?e.jsx(Zr,{...u,ref:s,onThumbPositionChange:()=>{if(t.viewport&&a.current){const x=t.viewport.scrollTop,b=qe(x,c);a.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:x=>{t.viewport&&(t.viewport.scrollTop=x)},onDragScroll:x=>{t.viewport&&(t.viewport.scrollTop=m(x))}}):null}),Jr=i.forwardRef((o,s)=>{const{sizes:r,onSizesChange:n,...t}=o,a=z($,o.__scopeScrollArea),[d,c]=i.useState(),p=i.useRef(null),h=X(s,p,a.onScrollbarXChange);return i.useEffect(()=>{p.current&&c(getComputedStyle(p.current))},[p]),e.jsx(Eo,{"data-orientation":"horizontal",...t,ref:h,sizes:r,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":we(r)+"px",...o.style},onThumbPointerDown:u=>o.onThumbPointerDown(u.x),onDragScroll:u=>o.onDragScroll(u.x),onWheelScroll:(u,m)=>{if(a.viewport){const x=a.viewport.scrollLeft+u.deltaX;o.onWheelScroll(x),Lo(x,m)&&u.preventDefault()}},onResize:()=>{p.current&&a.viewport&&d&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:p.current.clientWidth,paddingStart:be(d.paddingLeft),paddingEnd:be(d.paddingRight)}})}})}),Zr=i.forwardRef((o,s)=>{const{sizes:r,onSizesChange:n,...t}=o,a=z($,o.__scopeScrollArea),[d,c]=i.useState(),p=i.useRef(null),h=X(s,p,a.onScrollbarYChange);return i.useEffect(()=>{p.current&&c(getComputedStyle(p.current))},[p]),e.jsx(Eo,{"data-orientation":"vertical",...t,ref:h,sizes:r,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":we(r)+"px",...o.style},onThumbPointerDown:u=>o.onThumbPointerDown(u.y),onDragScroll:u=>o.onDragScroll(u.y),onWheelScroll:(u,m)=>{if(a.viewport){const x=a.viewport.scrollTop+u.deltaY;o.onWheelScroll(x),Lo(x,m)&&u.preventDefault()}},onResize:()=>{p.current&&a.viewport&&d&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:p.current.clientHeight,paddingStart:be(d.paddingTop),paddingEnd:be(d.paddingBottom)}})}})}),[et,To]=No($),Eo=i.forwardRef((o,s)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:t,onThumbChange:a,onThumbPointerUp:d,onThumbPointerDown:c,onThumbPositionChange:p,onDragScroll:h,onWheelScroll:u,onResize:m,...x}=o,b=z($,r),[w,N]=i.useState(null),D=X(s,f=>N(f)),y=i.useRef(null),S=i.useRef(""),T=b.viewport,A=n.content-n.viewport,E=G(u),P=G(p),F=Se(m,10);function C(f){if(y.current){const j=f.clientX-y.current.left,_=f.clientY-y.current.top;h({x:j,y:_})}}return i.useEffect(()=>{const f=j=>{const _=j.target;(w==null?void 0:w.contains(_))&&E(j,A)};return document.addEventListener("wheel",f,{passive:!1}),()=>document.removeEventListener("wheel",f,{passive:!1})},[T,w,A,E]),i.useEffect(P,[n,P]),oe(w,F),oe(b.content,F),e.jsx(et,{scope:r,scrollbar:w,hasThumb:t,onThumbChange:G(a),onThumbPointerUp:G(d),onThumbPositionChange:P,onThumbPointerDown:G(c),children:e.jsx(H.div,{...x,ref:D,style:{position:"absolute",...x.style},onPointerDown:W(o.onPointerDown,f=>{f.button===0&&(f.target.setPointerCapture(f.pointerId),y.current=w.getBoundingClientRect(),S.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),C(f))}),onPointerMove:W(o.onPointerMove,C),onPointerUp:W(o.onPointerUp,f=>{const j=f.target;j.hasPointerCapture(f.pointerId)&&j.releasePointerCapture(f.pointerId),document.body.style.webkitUserSelect=S.current,b.viewport&&(b.viewport.style.scrollBehavior=""),y.current=null})})})}),fe="ScrollAreaThumb",Io=i.forwardRef((o,s)=>{const{forceMount:r,...n}=o,t=To(fe,o.__scopeScrollArea);return e.jsx(ne,{present:r||t.hasThumb,children:e.jsx(ot,{ref:s,...n})})}),ot=i.forwardRef((o,s)=>{const{__scopeScrollArea:r,style:n,...t}=o,a=z(fe,r),d=To(fe,r),{onThumbPositionChange:c}=d,p=X(s,m=>d.onThumbChange(m)),h=i.useRef(void 0),u=Se(()=>{h.current&&(h.current(),h.current=void 0)},100);return i.useEffect(()=>{const m=a.viewport;if(m){const x=()=>{if(u(),!h.current){const b=st(m,c);h.current=b,c()}};return c(),m.addEventListener("scroll",x),()=>m.removeEventListener("scroll",x)}},[a.viewport,u,c]),e.jsx(H.div,{"data-state":d.hasThumb?"visible":"hidden",...t,ref:p,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:W(o.onPointerDownCapture,m=>{const b=m.target.getBoundingClientRect(),w=m.clientX-b.left,N=m.clientY-b.top;d.onThumbPointerDown({x:w,y:N})}),onPointerUp:W(o.onPointerUp,d.onThumbPointerUp)})});Io.displayName=fe;var Me="ScrollAreaCorner",_o=i.forwardRef((o,s)=>{const r=z(Me,o.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?e.jsx(rt,{...o,ref:s}):null});_o.displayName=Me;var rt=i.forwardRef((o,s)=>{const{__scopeScrollArea:r,...n}=o,t=z(Me,r),[a,d]=i.useState(0),[c,p]=i.useState(0),h=!!(a&&c);return oe(t.scrollbarX,()=>{var m;const u=((m=t.scrollbarX)==null?void 0:m.offsetHeight)||0;t.onCornerHeightChange(u),p(u)}),oe(t.scrollbarY,()=>{var m;const u=((m=t.scrollbarY)==null?void 0:m.offsetWidth)||0;t.onCornerWidthChange(u),d(u)}),h?e.jsx(H.div,{...n,ref:s,style:{width:a,height:c,position:"absolute",right:t.dir==="ltr"?0:void 0,left:t.dir==="rtl"?0:void 0,bottom:0,...o.style}}):null});function be(o){return o?parseInt(o,10):0}function Po(o,s){const r=o/s;return isNaN(r)?0:r}function we(o){const s=Po(o.viewport,o.content),r=o.scrollbar.paddingStart+o.scrollbar.paddingEnd,n=(o.scrollbar.size-r)*s;return Math.max(n,18)}function tt(o,s,r,n="ltr"){const t=we(r),a=t/2,d=s||a,c=t-d,p=r.scrollbar.paddingStart+d,h=r.scrollbar.size-r.scrollbar.paddingEnd-c,u=r.content-r.viewport,m=n==="ltr"?[0,u]:[u*-1,0];return ko([p,h],m)(o)}function qe(o,s,r="ltr"){const n=we(s),t=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,a=s.scrollbar.size-t,d=s.content-s.viewport,c=a-n,p=r==="ltr"?[0,d]:[d*-1,0],h=hr(o,p);return ko([0,d],[0,c])(h)}function ko(o,s){return r=>{if(o[0]===o[1]||s[0]===s[1])return s[0];const n=(s[1]-s[0])/(o[1]-o[0]);return s[0]+n*(r-o[0])}}function Lo(o,s){return o>0&&o<s}var st=(o,s=()=>{})=>{let r={left:o.scrollLeft,top:o.scrollTop},n=0;return function t(){const a={left:o.scrollLeft,top:o.scrollTop},d=r.left!==a.left,c=r.top!==a.top;(d||c)&&s(),r=a,n=window.requestAnimationFrame(t)}(),()=>window.cancelAnimationFrame(n)};function Se(o,s){const r=G(o),n=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(n.current),[]),i.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,s)},[r,s])}function oe(o,s){const r=G(s);Ye(()=>{let n=0;if(o){const t=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return t.observe(o),()=>{window.cancelAnimationFrame(n),t.unobserve(o)}}},[o,r])}var Mo=yo,at=Ao,nt=_o;const Fo=i.forwardRef(({className:o,children:s,...r},n)=>e.jsxs(Mo,{ref:n,className:le("relative overflow-hidden",o),...r,children:[e.jsx(at,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(Oo,{}),e.jsx(nt,{})]}));Fo.displayName=Mo.displayName;const Oo=i.forwardRef(({className:o,orientation:s="vertical",...r},n)=>e.jsx(ke,{ref:n,orientation:s,className:le("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",o),...r,children:e.jsx(Io,{className:"relative flex-1 rounded-full bg-border"})}));Oo.displayName=ke.displayName;const k="all";function lt({isOpen:o,onClose:s,onExercisesSelect:r}){const[n,t]=i.useState(""),[a,d]=i.useState("todos"),[c,p]=i.useState([]),[h,u]=i.useState(k),[m,x]=i.useState(k),[b,w]=i.useState(!1),{toast:N}=Je(),{data:D=[],isLoading:y,error:S}=oo({queryKey:["bibliotecaExercicios",a],queryFn:()=>sr(`/api/exercicios/biblioteca?tipo=${a}`),enabled:o,staleTime:1e3*60*5});i.useEffect(()=>{o?N({title:"Dica de Filtro",description:"Clique em 'Filtros' para expandir/recolher as opções.",duration:4e3}):(t(""),d("todos"),p([]),u(k),x(k),w(!1))},[o,N]);const T=i.useMemo(()=>{let f=D;return n&&(f=f.filter(j=>j.nome.toLowerCase().includes(n.toLowerCase()))),h!==k&&(f=f.filter(j=>j.grupoMuscular===h)),m!==k&&(f=f.filter(j=>j.categoria===m)),f.sort((j,_)=>j.nome.localeCompare(_.nome))},[D,n,h,m]),A=f=>{p(j=>j.some(_=>_._id===f._id)?j.filter(_=>_._id!==f._id):[...j,f])},E=()=>{r(c)},P=()=>{t(""),u(k),x(k)},F=i.useMemo(()=>{const f=new Set(D.map(j=>j.grupoMuscular).filter(Boolean));return[k,...Array.from(f).sort()]},[D]),C=i.useMemo(()=>{const f=new Set(D.map(j=>j.categoria).filter(Boolean));return[k,...Array.from(f).sort()]},[D]);return S?e.jsx(ce,{open:o,onOpenChange:s,children:e.jsxs(de,{className:"sm:max-w-lg",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Erro"}),e.jsxs(he,{children:["Ocorreu um erro ao carregar os exercícios: ",S.message]})]}),e.jsx(pe,{children:e.jsx(R,{onClick:s,children:"Fechar"})})]})}):e.jsx(ce,{open:o,onOpenChange:s,children:e.jsxs(de,{className:"sm:max-w-3xl flex flex-col h-[90vh] p-0",children:[e.jsxs(ue,{className:"p-6 pb-4 border-b shrink-0",children:[e.jsx(me,{children:"Selecionar Exercício(s) da Biblioteca"}),e.jsx(he,{children:"Use as abas e filtros para encontrar e selecionar os exercícios."})]}),e.jsxs("div",{className:"p-6 flex flex-col flex-grow overflow-hidden",children:[e.jsx(xr,{value:a,onValueChange:f=>d(f),className:"mb-4 shrink-0",children:e.jsxs(fr,{className:"grid w-full grid-cols-4",children:[e.jsx(ie,{value:"todos",children:"Todos"}),e.jsx(ie,{value:"app",children:"App"}),e.jsx(ie,{value:"meus",children:"Meus"}),e.jsx(ie,{value:"favoritos",children:"Favoritos"})]})}),e.jsx("div",{className:"mb-4 shrink-0",children:e.jsxs(R,{variant:"outline",className:"w-full",onClick:()=>w(!b),children:[e.jsx(Dr,{className:"mr-2 h-4 w-4"}),"Filtros",b?e.jsx(pr,{className:"ml-2 h-4 w-4"}):e.jsx(Ke,{className:"ml-2 h-4 w-4"})]})}),b&&e.jsxs("div",{className:"space-y-3 mb-4 shrink-0",children:[e.jsx(q,{placeholder:"Buscar por nome...",value:n,onChange:f=>t(f.target.value)}),e.jsxs(Q,{value:h,onValueChange:u,children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Todos os Grupos"})}),e.jsx(ee,{children:F.map(f=>e.jsx(K,{value:f,children:f===k?"Todos os Grupos":f},f))})]}),e.jsxs(Q,{value:m,onValueChange:x,children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Todas as Categorias"})}),e.jsx(ee,{children:C.map(f=>e.jsx(K,{value:f,children:f===k?"Todas as Categorias":f},f))})]}),(n||h!==k||m!==k)&&e.jsxs(R,{variant:"ghost",onClick:P,className:"w-full text-red-500 hover:text-red-600",children:[e.jsx(br,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]}),e.jsx(Fo,{className:"flex-grow pr-4 -mr-4",children:y?e.jsx("div",{className:"flex justify-center items-center py-10",children:e.jsx(Ze,{className:"h-8 w-8 animate-spin text-primary"})}):T.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-10",children:"Nenhum exercício encontrado."}):e.jsx("div",{className:"space-y-2",children:T.map(f=>{const j=c.some(_=>_._id===f._id);return e.jsxs("div",{onClick:()=>A(f),className:`p-3 border rounded-md cursor-pointer flex justify-between items-center transition-colors ${j?"bg-primary/10 border-primary ring-2 ring-primary":"hover:bg-muted/50"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${j?"text-primary":""}`,children:f.nome}),e.jsx("span",{className:"text-xs text-muted-foreground",children:f.grupoMuscular||"N/A"})]}),j&&e.jsx(Cr,{className:"w-5 h-5 text-primary shrink-0"})]},f._id)})})})]}),e.jsxs(pe,{className:"p-6 pt-4 border-t shrink-0",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mr-auto",children:[c.length," selecionado(s)"]}),e.jsx(R,{variant:"outline",onClick:s,children:"Cancelar"}),e.jsx(R,{onClick:E,disabled:c.length===0,children:"Adicionar"})]})]})})}const it=[{value:"diasDaSemana",label:"Dia da Semana"},{value:"numerico",label:"Numérico (A, B, C...)"},{value:"livre",label:"Livre (Nomes)"}],ct=["Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado","Domingo"],dt=({currentStep:o})=>e.jsxs("div",{className:"flex items-center w-full mb-8 px-2",children:[" ",[{num:1,label:"Detalhes"},{num:2,label:"Dias"},{num:3,label:"Exercícios"}].map(({num:s,label:r},n,t)=>e.jsxs(L.Fragment,{children:[" ",e.jsxs("div",{className:"flex flex-col items-center shrink-0 text-center",children:[" ",e.jsxs("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg transition-all duration-300 ${o>=s?"bg-primary text-primary-foreground scale-110 shadow-lg":"bg-slate-200 dark:bg-slate-700 text-slate-500"}`,children:[" ",s," "]})," ",e.jsx("p",{className:`text-xs mt-2 font-semibold transition-colors w-20 ${o>=s?"text-primary":"text-slate-500"}`,children:r})," "]})," ",n<t.length-1&&e.jsx("div",{className:`flex-auto border-t-2 mx-2 transition-colors ${o>s?"border-primary":"border-slate-200 dark:border-slate-700"}`})," "]},s))," "]});function _t({open:o,onClose:s,onSuccess:r,alunos:n,rotinaParaEditar:t}){var Oe,ze;const[a,d]=i.useState(1),{toast:c}=Je(),p=ar(),h=!!(t!=null&&t._id),[u,m]=i.useState({titulo:"",descricao:null,tipo:"modelo",alunoId:null}),[x,b]=i.useState({tipoOrganizacaoRotina:"numerico"}),[w,N]=i.useState([]),[D,y]=i.useState(!1),[S,T]=i.useState(null),[A,E]=i.useState({identificadorDia:"",nomeSubFicha:null}),[P,F]=i.useState(!1),[C,f]=i.useState(null);i.useEffect(()=>{if(o){if(h&&t){const l=typeof t.alunoId=="object"&&t.alunoId!==null?t.alunoId._id:t.alunoId;m({titulo:t.titulo||"",descricao:t.descricao||null,tipo:t.tipo||"modelo",alunoId:l}),b({tipoOrganizacaoRotina:t.tipoOrganizacaoRotina||"numerico"});const v=(t.diasDeTreino||[]).map((g,I)=>({...g,tempId:g._id||`edit-dia-${I}-${Date.now()}`,exerciciosDoDia:(g.exerciciosDoDia||[]).filter(M=>M.exercicioId).map((M,O)=>({...M,tempIdExercicio:M._id||`edit-ex-${I}-${O}-${Date.now()}`}))}));N(v),v.length>0&&f(v[0].tempId)}else m({titulo:"",descricao:null,tipo:"modelo",alunoId:null}),b({tipoOrganizacaoRotina:"numerico"}),N([]),f(null);d(1),y(!1),T(null)}},[o,h,t]);const{data:j=[],isLoading:_}=oo({queryKey:["/api/aluno/gerenciar"],queryFn:()=>Ve("GET","/api/aluno/gerenciar"),enabled:o&&u.tipo==="individual",initialData:n}),Fe=()=>{if(a===1&&!u.titulo.trim()){c({variant:"destructive",title:"Campo obrigatório",description:"O título da rotina é obrigatório."});return}if(a===1&&u.tipo==="individual"&&!u.alunoId){c({variant:"destructive",title:"Campo obrigatório",description:"Selecione um aluno."});return}if(a===2&&w.length===0){c({variant:"destructive",title:"Atenção",description:"Adicione pelo menos um dia de treino."});return}a===2&&w.length>0&&!C&&f(w[0].tempId),d(l=>Math.min(l+1,3))},zo=()=>d(l=>Math.max(l-1,1)),Ce=mr({mutationFn:l=>Ve(h?"PUT":"POST",h?`/api/treinos/${t==null?void 0:t._id}`:"/api/treinos",l),onSuccess:l=>{c({title:"Sucesso!",description:`Rotina "${l.titulo}" salva.`}),p.invalidateQueries({queryKey:["/api/treinos"]}),r(l),s()},onError:l=>c({variant:"destructive",title:"Erro ao Salvar",description:l.message})}),Vo=()=>{const l={...u,...x,diasDeTreino:w.map(v=>({_id:v._id,identificadorDia:v.identificadorDia,nomeSubFicha:v.nomeSubFicha,ordemNaRotina:v.ordemNaRotina,exerciciosDoDia:v.exerciciosDoDia.map(g=>({_id:g._idSubDocExercicio,exercicioId:typeof g.exercicioId=="object"?g.exercicioId._id:g.exercicioId,series:g.series,repeticoes:g.repeticoes,carga:g.carga,descanso:g.descanso,observacoes:g.observacoes,ordemNoDia:g.ordemNoDia}))}))};console.log("Payload enviado:",l),Ce.mutate(l)},Ho=()=>{if(!A.identificadorDia.trim()){c({variant:"destructive",title:"Erro",description:"O identificador do dia é obrigatório."});return}if(w.some(v=>v.identificadorDia.toLowerCase()===A.identificadorDia.toLowerCase()&&v.tempId!==S)){c({variant:"destructive",title:"Erro",description:`O identificador "${A.identificadorDia}" já foi usado.`});return}N(v=>{let g=[...v];return S?g=g.map(I=>I.tempId===S?{...I,...A,nomeSubFicha:A.nomeSubFicha||null}:I):g.push({...A,nomeSubFicha:A.nomeSubFicha||null,tempId:`new-${Date.now()}`,ordemNaRotina:v.length,exerciciosDoDia:[]}),g}),y(!1),T(null),E({identificadorDia:"",nomeSubFicha:null})},$o=l=>{E({identificadorDia:l.identificadorDia,nomeSubFicha:l.nomeSubFicha||null}),T(l.tempId),y(!0)},Bo=l=>{N(v=>v.filter(g=>g.tempId!==l).map((g,I)=>({...g,ordemNaRotina:I})))},Wo=()=>{T(null),E({identificadorDia:"",nomeSubFicha:null}),y(!0)},Uo=l=>{f(l),F(!0)},qo=l=>{C&&(N(v=>v.map(g=>{if(g.tempId===C){const I=l.map((M,O)=>{var B;return{_id:`new-ex-${Date.now()}-${O}`,exercicioId:{_id:M._id,nome:M.nome,grupoMuscular:M.grupoMuscular,categoria:M.categoria},ordemNoDia:(((B=g.exerciciosDoDia)==null?void 0:B.length)||0)+O}});return{...g,exerciciosDoDia:[...g.exerciciosDoDia||[],...I]}}return g})),F(!1))},re=(l,v,g,I)=>{N(M=>M.map(O=>{if(O.tempId===l){const B=[...O.exerciciosDoDia];return B[v][g]=I,{...O,exerciciosDoDia:B}}return O}))},Xo=(l,v)=>{N(g=>g.map(I=>{if(I.tempId===l){const M=I.exerciciosDoDia.filter((O,B)=>B!==v);return{...I,exerciciosDoDia:M.map((O,B)=>({...O,ordemNoDia:B}))}}return I}))},Yo=i.useMemo(()=>w.map(l=>l.identificadorDia),[w]);return e.jsxs(ce,{open:o,onOpenChange:s,children:[e.jsxs(de,{className:"sm:max-w-4xl w-[95vw] h-[90vh] flex flex-col p-0",children:[e.jsxs(ue,{className:"p-6 pb-4 border-b shrink-0",children:[e.jsx(me,{children:h?"Editar Rotina":"Nova Rotina"}),e.jsx(he,{children:"Siga os passos para configurar a rotina de treino."})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[e.jsx(dt,{currentStep:a}),a===1&&e.jsxs("div",{className:"space-y-4 animate-in fade-in-50",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"font-semibold",children:"Título da Rotina*"}),e.jsx(q,{value:u.titulo,onChange:l=>m(v=>({...v,titulo:l.target.value}))})]}),e.jsxs("div",{children:[e.jsx(Y,{className:"font-semibold",children:"Descrição (Opcional)"}),e.jsx(We,{value:u.descricao||"",onChange:l=>m(v=>({...v,descricao:l.target.value}))})]}),e.jsxs("div",{children:[e.jsx(Y,{className:"font-semibold",children:"Tipo de Rotina"}),e.jsxs(Q,{value:u.tipo,onValueChange:l=>m(v=>({...v,tipo:l,alunoId:null})),disabled:h,children:[e.jsx(J,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(K,{value:"modelo",children:"Modelo"}),e.jsx(K,{value:"individual",children:"Individual"})]})]})]}),u.tipo==="individual"&&e.jsxs("div",{children:[e.jsx(Y,{className:"font-semibold",children:"Aluno*"}),e.jsxs(Q,{value:u.alunoId||"",onValueChange:l=>m(v=>({...v,alunoId:l})),disabled:h,children:[e.jsx(J,{children:_?e.jsx("span",{className:"text-muted-foreground",children:"Carregando alunos..."}):e.jsx(Z,{placeholder:"Selecione um aluno..."})}),e.jsx(ee,{children:j.map(l=>e.jsx(K,{value:l._id,children:l.nome},l._id))})]})]})]}),a===2&&e.jsxs("div",{className:"space-y-6 animate-in fade-in-50",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"font-semibold",children:"Organização dos Dias*"}),e.jsxs(Q,{value:x.tipoOrganizacaoRotina,onValueChange:l=>b(v=>({...v,tipoOrganizacaoRotina:l})),children:[e.jsx(J,{children:e.jsx(Z,{})}),e.jsx(ee,{children:it.map(l=>e.jsx(K,{value:l.value,children:l.label},l.value))})]})]}),e.jsx("div",{className:"space-y-2",children:w.map(l=>e.jsxs(ae,{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 border-l-4 border-l-primary",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:l.identificadorDia}),l.nomeSubFicha&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l.nomeSubFicha})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>$o(l),children:e.jsx(eo,{className:"h-4 w-4 text-slate-500"})}),e.jsx(R,{variant:"ghost",size:"icon",className:"h-7 w-7 text-red-500",onClick:()=>Bo(l.tempId),children:e.jsx(vr,{className:"h-4 w-4"})})]})]},l.tempId))}),D&&e.jsx(ae,{className:"p-4 border-dashed",children:e.jsxs(Qe,{className:"p-0 space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:S?"Editando Dia":"Novo Dia de Treino"}),e.jsxs("div",{children:[e.jsx(Y,{children:"Identificador do Dia*"}),x.tipoOrganizacaoRotina==="diasDaSemana"?e.jsxs(Q,{value:A.identificadorDia,onValueChange:l=>E(v=>({...v,identificadorDia:l})),children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Selecione um dia..."})}),e.jsx(ee,{children:ct.map(l=>e.jsx(K,{value:l,disabled:Yo.includes(l),children:l},l))})]}):e.jsx(q,{value:A.identificadorDia,onChange:l=>E(v=>({...v,identificadorDia:l.target.value})),placeholder:x.tipoOrganizacaoRotina==="numerico"?`Ex: Treino ${w.length+1}`:"Ex: Peito & Tríceps"})]}),e.jsxs("div",{children:[e.jsx(Y,{children:"Nome Específico (Opcional)"}),e.jsx(q,{value:A.nomeSubFicha||"",onChange:l=>E(v=>({...v,nomeSubFicha:l.target.value})),placeholder:"Ex: Foco em Força"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(R,{variant:"ghost",onClick:()=>y(!1),children:"Cancelar"}),e.jsx(R,{onClick:Ho,children:S?"Atualizar":"Adicionar"})]})]})}),!D&&e.jsxs(R,{variant:"outline",className:"w-full border-dashed border-primary text-primary hover:text-primary hover:bg-primary/5",onClick:Wo,children:[e.jsx(Nr,{className:"mr-2 h-4 w-4"})," Adicionar Dia de Treino"]})]}),a===3&&e.jsxs("div",{className:"flex flex-col md:flex-row h-full max-h-full overflow-hidden",children:[" ",e.jsxs("div",{className:"md:col-span-1 border-b md:border-b-0 md:border-r dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50 p-4 overflow-y-auto w-full md:w-1/3 lg:w-1/4 shrink-0",children:[" ",e.jsx("h3",{className:"font-semibold mb-3",children:"Dias de Treino"}),e.jsx("div",{className:"space-y-2",children:w.map(l=>e.jsx(R,{variant:C===l.tempId?"secondary":"ghost",className:"w-full justify-start text-left h-auto py-2",onClick:()=>f(l.tempId),children:e.jsxs("span",{className:"flex flex-col",children:[e.jsx("span",{children:l.identificadorDia}),l.nomeSubFicha&&e.jsx("span",{className:"text-xs font-normal opacity-70",children:l.nomeSubFicha})]})},l.tempId))})]}),e.jsxs("div",{className:"md:col-span-2 p-4 overflow-y-auto flex-grow",children:[" ",C&&w.find(l=>l.tempId===C)?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold",children:["Exercícios do Dia: ",(Oe=w.find(l=>l.tempId===C))==null?void 0:Oe.identificadorDia]}),(((ze=w.find(l=>l.tempId===C))==null?void 0:ze.exerciciosDoDia)||[]).map((l,v)=>l.exercicioId?e.jsxs(ae,{className:"p-3 bg-white dark:bg-slate-800/60 shadow-sm border-l-4 border-primary/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("p",{className:"font-medium text-sm",children:typeof l.exercicioId=="object"&&l.exercicioId.nome||"Exercício"}),e.jsx(R,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive/70 hover:text-destructive shrink-0",onClick:()=>Xo(C,v),children:e.jsx(dr,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[e.jsx(q,{placeholder:"Séries",value:l.series||"",onChange:g=>re(C,v,"series",g.target.value)}),e.jsx(q,{placeholder:"Reps",value:l.repeticoes||"",onChange:g=>re(C,v,"repeticoes",g.target.value)}),e.jsx(q,{placeholder:"Carga",value:l.carga||"",onChange:g=>re(C,v,"carga",g.target.value)}),e.jsx(q,{placeholder:"Descanso",value:l.descanso||"",onChange:g=>re(C,v,"descanso",g.target.value)})]}),e.jsx(We,{placeholder:"Observações...",value:l.observacoes||"",onChange:g=>re(C,v,"observacoes",g.target.value),className:"mt-2 text-xs",rows:1})]},l._id||l.tempIdExercicio||v):e.jsx(ae,{className:"p-3 bg-red-50 dark:bg-red-900/30 border-l-4 border-red-500",children:e.jsxs("p",{className:"text-red-600 dark:text-red-400 text-sm flex items-center",children:[e.jsx(gr,{className:"h-4 w-4 mr-2"}),"Este exercício foi removido e não pode ser editado."]})},v)),e.jsxs(R,{variant:"outline",className:"w-full border-dashed",onClick:()=>Uo(C),children:[e.jsx(Rr,{className:"mr-2 h-4 w-4"}),"Adicionar Exercício"]})]}):e.jsxs("div",{className:"text-center text-muted-foreground pt-20 flex flex-col items-center",children:[e.jsx("p",{className:"font-semibold",children:"Nenhum dia selecionado"}),e.jsx("p",{className:"text-sm",children:"Selecione um dia de treino à esquerda."})]})]})]})]}),e.jsxs(pe,{className:"p-4 border-t flex justify-between shrink-0",children:[e.jsx("div",{children:a>1&&e.jsxs(R,{variant:"outline",onClick:zo,children:[e.jsx(jr,{className:"mr-2 h-4 w-4"})," Voltar"]})}),e.jsxs("div",{children:[a<3&&e.jsxs(R,{onClick:Fe,disabled:a===2&&w.length===0,children:["Próximo ",e.jsx(wr,{className:"ml-2 h-4 w-4"})]}),a===3&&e.jsxs(R,{onClick:Vo,disabled:Ce.isPending,children:[Ce.isPending&&e.jsx(Ze,{className:"mr-2 h-4 w-4 animate-spin"})," ",h?"Salvar Alterações":"Criar Rotina"]})]})]})]}),P&&e.jsx(lt,{isOpen:P,onClose:()=>F(!1),onExercisesSelect:qo})]})}export{Xr as A,Sr as B,Cr as C,Ar as F,Et as R,Rt as S,_t as a,Nr as b,yr as c,wo as d,So as e,Co as f};
