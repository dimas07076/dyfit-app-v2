import{t as I,s as O,o as L,r as b,m as f,j as e,C as A,a as M,b as k,d as N,e as q,I as l,B as z,n as B}from"./index-BzLV8CNE.js";import{u as H}from"./useQuery-PwrN8lgt.js";import{u as R}from"./useMutation-CMAM4n7S.js";import{u as G,t as $,o as K,s as c,e as Q}from"./types-BCbViMJN.js";import{F as J,b as s,c as o,d as t,a as n,e as i}from"./form-Bay0436k.js";import{S as v,a as w,b as C,c as S,d}from"./select-WeAdnBMh.js";import{E as U}from"./ErrorMessage-CKvNOnls.js";import{L as W}from"./LoadingSpinner-CMtr6_ld.js";import"./label-ErXilaHi.js";import"./triangle-alert-BMd-Rj3a.js";const X=K({email:c().email("Por favor, insira um e-mail válido.").optional(),nome:c().min(3,"Nome completo é obrigatório."),password:c().min(6,"A senha deve ter no mínimo 6 caracteres."),confirmPassword:c(),phone:c().optional(),birthDate:c().min(1,"Data de nascimento é obrigatória."),gender:Q(["masculino","feminino","outro"]),goal:c().min(1,"Objetivo é obrigatório."),weight:c().min(1,"Peso é obrigatório.").refine(m=>!isNaN(parseFloat(m.replace(",","."))),"Deve ser um número."),height:c().min(1,"Altura é obrigatória.").refine(m=>/^\d+$/.test(m),"Deve ser um número inteiro."),startDate:c()}).refine(m=>m.password===m.confirmPassword,{message:"As senhas não coincidem.",path:["confirmPassword"]}).refine(m=>!!m.email,{message:"O e-mail é obrigatório.",path:["email"]}),le=()=>{const g=I().token,[,F]=O(),{toast:j}=L(),[p,P]=b.useState(null),[y,D]=b.useState(null),a=G({resolver:$(X),defaultValues:{email:"",nome:"",password:"",confirmPassword:"",phone:"",birthDate:"",goal:"",weight:"",height:"",startDate:new Date().toISOString().split("T")[0]}}),{isLoading:E,isError:T,error:x}=H({queryKey:["validateAlunoInvite",g],queryFn:async()=>{const r=await f("GET",`/api/public/convite-aluno/${g}`);return r.email&&(P(r.email),a.setValue("email",r.email)),D(r.personalName),r},enabled:!!g,retry:!1}),h=R({mutationFn:r=>{const{confirmPassword:Y,...u}=r;return f("POST","/api/public/convite-aluno/registrar",{token:g,...u,weight:parseFloat(u.weight.replace(",",".")),height:parseInt(u.height,10)})},onSuccess:()=>{j({title:"Cadastro realizado com sucesso!",description:"Você já pode fazer login com seu e-mail e senha."}),F("/aluno/login")},onError:r=>{j({variant:"destructive",title:"Erro no Cadastro",description:r.message})}}),V=r=>h.mutate(r);return E?e.jsx(W,{text:"Validando convite..."}):T?e.jsx(U,{title:"Convite Inválido",message:(x==null?void 0:x.message)||"O link de convite que você usou é inválido ou já expirou."}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs(A,{className:"w-full max-w-lg bg-white text-gray-800 shadow-lg",children:[e.jsxs(M,{className:"text-center pb-4",children:[e.jsx("img",{src:"/logodyfit.png",alt:"DyFit Logo",className:"mx-auto mb-4 h-12 w-auto"}),e.jsx(k,{className:"text-2xl font-bold text-primary",children:"Bem-vindo(a) ao DyFit!"}),y&&e.jsxs(N,{className:"text-lg text-gray-600 mt-2",children:["Seu personal, ",e.jsx("span",{className:"font-semibold text-primary",children:y}),", te convidou."]}),e.jsx(N,{className:"text-gray-600",children:"Complete seus dados para acessar a plataforma."})]}),e.jsx(q,{children:e.jsx(J,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(V),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p?e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Email"}),e.jsx(t,{children:e.jsx(l,{value:p,disabled:!0,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})})]}):e.jsx(n,{control:a.control,name:"email",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Email*"}),e.jsx(t,{children:e.jsx(l,{placeholder:"seu.email@exemplo.com",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"nome",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Nome Completo*"}),e.jsx(t,{children:e.jsx(l,{placeholder:"Seu nome completo",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"password",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Crie uma Senha*"}),e.jsx(t,{children:e.jsx(l,{type:"password",placeholder:"Mínimo de 6 caracteres",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"confirmPassword",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Confirme sua Senha*"}),e.jsx(t,{children:e.jsx(l,{type:"password",placeholder:"Repita a senha",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"phone",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Telefone"}),e.jsx(t,{children:e.jsx(l,{placeholder:"(00) 00000-0000",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"birthDate",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Data de Nascimento*"}),e.jsx(t,{children:e.jsx(l,{type:"date",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"gender",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Gênero*"}),e.jsxs(v,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(t,{children:e.jsx(w,{className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary",children:e.jsx(C,{placeholder:"Selecione..."})})}),e.jsxs(S,{className:"bg-white text-gray-800 border-gray-300",children:[e.jsx(d,{value:"masculino",children:"Masculino"}),e.jsx(d,{value:"feminino",children:"Feminino"}),e.jsx(d,{value:"outro",children:"Outro"})]})]}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"goal",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Objetivo Principal*"}),e.jsxs(v,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(t,{children:e.jsx(w,{className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary",children:e.jsx(C,{placeholder:"Selecione..."})})}),e.jsxs(S,{className:"bg-white text-gray-800 border-gray-300",children:[e.jsx(d,{value:"Hipertrofia",children:"Hipertrofia"}),e.jsx(d,{value:"Emagrecimento",children:"Emagrecimento"}),e.jsx(d,{value:"Outros",children:"Outros"})]})]}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"weight",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Peso (kg)*"}),e.jsx(t,{children:e.jsx(l,{placeholder:"Ex: 75.5",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"height",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Altura (cm)*"}),e.jsx(t,{children:e.jsx(l,{placeholder:"Ex: 178",...r,className:"bg-gray-50 border-gray-300 text-gray-800 focus:ring-primary"})}),e.jsx(i,{})]})}),e.jsx(n,{control:a.control,name:"startDate",render:({field:r})=>e.jsxs(s,{children:[e.jsx(o,{className:"text-gray-700",children:"Data de Início"}),e.jsx(t,{children:e.jsx(l,{type:"date",...r,disabled:!0,className:"bg-gray-50 border-gray-300 text-gray-800"})}),e.jsx(i,{})]})})]}),e.jsxs(z,{type:"submit",className:"w-full mt-6 bg-primary text-primary-foreground hover:bg-primary/90",disabled:h.isPending,children:[h.isPending&&e.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Finalizar Cadastro"]})]})})})]})})};export{le as default};
